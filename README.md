# Анализ данных о ресторанах Лондона

Данный проект посвящен анализу данных о ресторанах Лондона с использованием методов машинного обучения (ML) и глубокого обучения (DL). Собранные данные позволяют провести комплексный анализ ресторанного бизнеса, включая изучение рейтингов, ценовых диапазонов, популярности различных кухонь и других факторов, влияющих на успех ресторанов.

## Описание проекта

В рамках проекта были собраны и проанализированы данные о ресторанах Лондона для последующего применения методов машинного и глубокого обучения. Сбор данных осуществлялся с использованием следующих источников:

| Источник данных | Метод сбора | Платформы |
|-----------------|------------|-----------|
| API сайтов | Автоматизированный сбор | Tripadvisor, Yelp |
| Веб-скрейпинг | Парсинг веб-страниц | OpenTable, Michelin Guide |

Эти данные послужили основой для построения моделей машинного обучения, направленных на решение задач классификации и анализа отзывов с использованием методов глубокого обучения.

## Очистка данных

После объединения данных, собранных с трех различных источников (Tripadvisor, Yelp, OpenTable), были выполнены следующие шаги по очистке данных:

1. **Удаление дубликатов**: Были обнаружены и удалены полностью совпадающие строки.
2. **Заполнение пропусков в дубликатах**: Пропуски в данных по названию ресторанов были заполнены путем совмещения информации из разных источников. После этого вторая строка-дубликат удалялась.
3. **Заполнение пропусков в колонках**:
   - `is_sponsored`: NaN → `False`
   - `has_delivery`: NaN → `False`
   - `is_premium`: NaN → `False`
   - `diets`: NaN → `'The menu does not match the diets'`
   - `reviews_rating_{1-5}`: NaN → `-1`

## Предобработка данных для машинного обучения

Перед началом классического машинного обучения датасет был дополнительно предобработан:

- **One-Hot Encoding** для колонок:
  - `cuisines` (виды кухни)
  - `diets` (типы диет)
  - `dining_options` (варианты обслуживания)
- **Разметка датасета**: разделение ресторанов на:
  - "good" (1) - рейтинг ≥ 4.0
  - "not so good" (0) - рейтинг < 4.0

## Описание данных после обработки

После обработки данные содержат следующие колонки:
   Категория | Колонка | Тип | Описание |
 |-----------|---------|-----|----------|
 | Основные характеристики | `name` | `object` | Наименование ресторана |
 | | `reviews` | `int64` | Количество отзывов |
 | | `rating` | `float64` | Рейтинг ресторана |
 | | `price_range` | `float64` | Ценовой диапазон |
 | | `is_sponsored` | `bool` | Статус спонсированности на Tripadvisor |
 | | `latitude` | `float64` | Широта расположения |
 | | `longitude` | `float64` | Долгота расположения |
 | Дополнительные признаки | `has_delivery` | `bool` | Наличие опции доставки |
 | | `is_premium` | `bool` | Принадлежность к премиум сегменту |
 | | `IsIn_MICHELIN_Guide` | `float64` | Упоминание в Michelin Guide |
 | | `is_close_to_sightseeing` | `int64` | Нахождение в радиусе 1 км от достопримечательности |
 | Данные об отзывах | `reviews_rating_1` | `float64` | Количество отзывов с оценкой 1 |
 | | `reviews_rating_2` | `float64` | Количество отзывов с оценкой 2 |
 | | `reviews_rating_3` | `float64` | Количество отзывов с оценкой 3 |
 | | `reviews_rating_4` | `float64` | Количество отзывов с оценкой 4 |
 | | `reviews_rating_5` | `float64` | Количество отзывов с оценкой 5 |
 | OHE-признаки | | | Кухни (`cuisines`), Диеты (`diets`), Варианты обслуживания (`dining_options`) |

## Машинное обучение

### Постановка задачи

**Бинарная классификация**: Понравится ли ресторан посетителям?

### Предобработка

- Удалены колонки, из которых может следовать ответ на задачу:
  - `name`, `rating`
  - `reviews_rating_1`, `reviews_rating_2`, `reviews_rating_3`, `reviews_rating_4`, `reviews_rating_5`

### Методология

- **Кросс-валидация**: `StratifiedKFold(n_splits=5)`
- **Трансформеры**:
  - `StandardScaler` – для числовых признаков
  - `SelectKBest(k=25)` – для OHE признаков

### Модели

1. **Бейзлайн**: Случайный лес с `n_estimators=115` и `max_features=15`
2. **Модели с подбором гиперпараметров (GridSearchCV)**:
   - Логистическая регрессия
   - Дерево решений
   - Случайный лес
   - XGBoost
   - LightGBM
   - Метод опорных векторов (SVC)
   - Многослойный перцептрон (MLPClassifier)

### Результаты

Все модели показали результат по **PR-AUC в диапазоне 0.91-0.93**

## Deep Learning: Анализ отзывов

### Задача

Бинарная классификация отзывов - негативный или позитивный

### Данные

Анализ причин негатива в отзывах посетителей в ресторанах ([ссылка на датасеты](https://drive.google.com/drive/folders/1UsHPlYAw6ha83_WbAmQneCJfQuAwqM0S?usp=sharing)):
- Азии
- Европы
- Америки

### Методы

- Использование **bag of words** для представления текста
- Обучение трех различных архитектур нейронных сетей:
  1. **Архитектура 1**: 3 линейных слоя
  2. **Архитектура 2**: 4 линейных слоя
  3. **Архитектура 3**: 3 слоя + 2 dropout слоя

### Результаты

Наилучшая модель была проверена на новых данных (отзывах):
- Модель хорошо отличает положительные отзывы от отрицательных
- Основная проблема: ошибки классификации из-за частицы "не" в отрицательных отзывах
